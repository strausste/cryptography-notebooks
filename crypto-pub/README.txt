The original code was taken from: https://github.com/bitbart/crypto-pub